name: Release Notifications

on:
  release:
    types: [published]
  workflow_dispatch:

jobs:
  notify:
    runs-on: self-hosted
    steps:
      - name: Refresh version & notify Discord
        env:
          API_WEBHOOK_KEY: ${{ secrets.API_WEBHOOK_KEY }}
        run: |
          REPO="${{ github.event.repository.name }}"
          curl -sf -X POST "https://api.zykeresources.com/webhook/github/release" \
            -H "Content-Type: application/json" \
            -H "X-Webhook-Key: $API_WEBHOOK_KEY" \
            -d "{\"repo\": \"$REPO\"}"
